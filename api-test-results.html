<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElectronAPI æµ‹è¯•ç»“æœ</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f7;
        }
        
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #007acc;
            padding-bottom: 20px;
        }
        
        .header h1 {
            color: #007acc;
            margin: 0;
            font-size: 2.5em;
        }
        
        .header p {
            color: #666;
            margin: 10px 0 0 0;
            font-size: 1.1em;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            background: #fafbfc;
        }
        
        .test-section h2 {
            color: #333;
            margin: 0 0 15px 0;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-success { background-color: #28a745; }
        .status-error { background-color: #dc3545; }
        .status-warning { background-color: #ffc107; }
        .status-info { background-color: #17a2b8; }
        
        .test-item {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .test-item:last-child {
            border-bottom: none;
        }
        
        .test-name {
            font-weight: 500;
        }
        
        .test-result {
            font-size: 0.9em;
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        .result-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .result-error {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .result-warning {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        .summary h3 {
            margin: 0 0 10px 0;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background-color: #007acc;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #005a9e;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .console-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
            white-space: pre-wrap;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007acc, #0056b3);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="header">
            <h1>ğŸ§ª ElectronAPI æµ‹è¯•ä¸­å¿ƒ</h1>
            <p>å…¨é¢æµ‹è¯•åº”ç”¨ä¸­çš„ ElectronAPI åŠŸèƒ½</p>
        </div>
        
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="runAllTests()">ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
            <button class="btn btn-secondary" onclick="runQuickTest()">âš¡ å¿«é€Ÿæµ‹è¯•</button>
            <button class="btn btn-secondary" onclick="clearResults()">ğŸ—‘ï¸ æ¸…é™¤ç»“æœ</button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
        
        <div id="testResults">
            <div class="summary" id="testSummary" style="display: none;">
                <h3 id="summaryTitle">æµ‹è¯•å‡†å¤‡ä¸­...</h3>
                <p id="summaryText">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•</p>
            </div>
            
            <!-- Shell API æµ‹è¯• -->
            <div class="test-section" id="shellTests">
                <h2><span class="status-indicator status-info"></span> Shell API æµ‹è¯•</h2>
                <div id="shellTestResults">
                    <p>ç­‰å¾…æµ‹è¯•...</p>
                </div>
            </div>
            
            <!-- å‰ªè´´æ¿ API æµ‹è¯• -->
            <div class="test-section" id="clipboardTests">
                <h2><span class="status-indicator status-info"></span> å‰ªè´´æ¿ API æµ‹è¯•</h2>
                <div id="clipboardTestResults">
                    <p>ç­‰å¾…æµ‹è¯•...</p>
                </div>
            </div>
            
            <!-- å¯¹è¯æ¡† API æµ‹è¯• -->
            <div class="test-section" id="dialogTests">
                <h2><span class="status-indicator status-info"></span> å¯¹è¯æ¡† API æµ‹è¯•</h2>
                <div id="dialogTestResults">
                    <p>ç­‰å¾…æµ‹è¯•...</p>
                </div>
            </div>
            
            <!-- åº”ç”¨ä¿¡æ¯ API æµ‹è¯• -->
            <div class="test-section" id="appInfoTests">
                <h2><span class="status-indicator status-info"></span> åº”ç”¨ä¿¡æ¯ API æµ‹è¯•</h2>
                <div id="appInfoTestResults">
                    <p>ç­‰å¾…æµ‹è¯•...</p>
                </div>
            </div>
            
            <!-- çª—å£æ§åˆ¶ API æµ‹è¯• -->
            <div class="test-section" id="windowTests">
                <h2><span class="status-indicator status-info"></span> çª—å£æ§åˆ¶ API æµ‹è¯•</h2>
                <div id="windowTestResults">
                    <p>ç­‰å¾…æµ‹è¯•...</p>
                </div>
            </div>
            
            <!-- å·¥å…·å‡½æ•°æµ‹è¯• -->
            <div class="test-section" id="utilityTests">
                <h2><span class="status-indicator status-info"></span> å·¥å…·å‡½æ•°æµ‹è¯•</h2>
                <div id="utilityTestResults">
                    <p>ç­‰å¾…æµ‹è¯•...</p>
                </div>
            </div>
        </div>
        
        <div class="console-output" id="consoleOutput">
            <div>ğŸ“‹ æ§åˆ¶å°è¾“å‡ºå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
            <div>ğŸ’¡ æç¤ºï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹æ›´è¯¦ç»†çš„æ—¥å¿—</div>
        </div>
    </div>

    <script>
        let testResults = {
            shell: {},
            clipboard: {},
            dialog: {},
            appInfo: {},
            window: {},
            utility: {}
        };
        
        let totalTests = 0;
        let completedTests = 0;
        
        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress() {
            const percentage = totalTests > 0 ? (completedTests / totalTests) * 100 : 0;
            document.getElementById('progressBar').style.width = percentage + '%';
        }
        
        // æ·»åŠ æ§åˆ¶å°è¾“å‡º
        function addConsoleOutput(message, type = 'info') {
            const console = document.getElementById('consoleOutput');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
            console.innerHTML += `<div>[${timestamp}] ${prefix} ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }
        
        // æ›´æ–°æµ‹è¯•ç»“æœæ˜¾ç¤º
        function updateTestSection(sectionId, tests) {
            const section = document.getElementById(sectionId + 'TestResults');
            const indicator = document.querySelector(`#${sectionId}Tests .status-indicator`);
            
            let html = '';
            let hasError = false;
            let hasSuccess = false;
            
            for (const [testName, result] of Object.entries(tests)) {
                const resultClass = result.success ? 'result-success' : 'result-error';
                const resultText = result.success ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥';
                
                if (result.success) hasSuccess = true;
                else hasError = true;
                
                html += `
                    <div class="test-item">
                        <div class="test-name">${testName}</div>
                        <div class="test-result ${resultClass}">${resultText}</div>
                    </div>
                `;
                
                if (result.details) {
                    html += `<div style="font-size: 0.8em; color: #666; margin-left: 20px;">${result.details}</div>`;
                }
            }
            
            section.innerHTML = html;
            
            // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
            if (hasError) {
                indicator.className = 'status-indicator status-error';
            } else if (hasSuccess) {
                indicator.className = 'status-indicator status-success';
            } else {
                indicator.className = 'status-indicator status-warning';
            }
        }
        
        // ç­‰å¾…APIå°±ç»ª
        async function waitForElectronAPI() {
            return new Promise((resolve) => {
                const checkAPI = () => {
                    if (window.electronAPI) {
                        addConsoleOutput('ElectronAPI å·²å°±ç»ª', 'success');
                        resolve(true);
                    } else {
                        setTimeout(checkAPI, 100);
                    }
                };
                checkAPI();
            });
        }
        
        // æµ‹è¯•Shell API
        async function testShellAPI() {
            addConsoleOutput('å¼€å§‹æµ‹è¯• Shell API...');
            
            const tests = {
                'openExternal': { success: !!window.electronAPI?.openExternal },
                'openPath': { success: !!window.electronAPI?.openPath },
                'trashItem': { success: !!window.electronAPI?.trashItem },
                'showItemInFolder': { success: !!window.electronAPI?.showItemInFolder }
            };
            
            // æµ‹è¯•å®é™…åŠŸèƒ½
            if (tests.openExternal.success) {
                try {
                    // è¿™é‡Œä¸å®é™…æ‰“å¼€é“¾æ¥ï¼Œåªæµ‹è¯•æ–¹æ³•å­˜åœ¨
                    tests.openExternal.details = 'æ–¹æ³•å¯ç”¨';
                } catch (error) {
                    tests.openExternal.success = false;
                    tests.openExternal.details = 'è°ƒç”¨å¤±è´¥: ' + error.message;
                }
            }
            
            testResults.shell = tests;
            updateTestSection('shell', tests);
            completedTests += Object.keys(tests).length;
            updateProgress();
            
            addConsoleOutput(`Shell API æµ‹è¯•å®Œæˆ: ${Object.values(tests).filter(t => t.success).length}/${Object.keys(tests).length} é€šè¿‡`);
        }
        
        // æµ‹è¯•å‰ªè´´æ¿API
        async function testClipboardAPI() {
            addConsoleOutput('å¼€å§‹æµ‹è¯• Clipboard API...');
            
            const tests = {
                'writeText': { success: !!window.electronAPI?.writeText },
                'readText': { success: !!window.electronAPI?.readText },
                'writeImage': { success: !!window.electronAPI?.writeImage },
                'readImage': { success: !!window.electronAPI?.readImage }
            };
            
            // å®é™…æµ‹è¯•å‰ªè´´æ¿å†™å…¥å’Œè¯»å–
            if (tests.writeText.success && tests.readText.success) {
                try {
                    const testText = 'ElectronAPI æµ‹è¯•æ–‡æœ¬ - ' + Date.now();
                    const writeResult = await window.electronAPI.writeText(testText);
                    if (writeResult.success) {
                        const readResult = await window.electronAPI.readText();
                        if (readResult.success && readResult.text === testText) {
                            tests.writeText.details = 'å†™å…¥æˆåŠŸ';
                            tests.readText.details = 'è¯»å–æˆåŠŸ';
                        } else {
                            tests.readText.success = false;
                            tests.readText.details = 'è¯»å–å¤±è´¥æˆ–å†…å®¹ä¸åŒ¹é…';
                        }
                    } else {
                        tests.writeText.success = false;
                        tests.writeText.details = 'å†™å…¥å¤±è´¥';
                    }
                } catch (error) {
                    tests.writeText.success = false;
                    tests.readText.success = false;
                    tests.writeText.details = 'æµ‹è¯•å¼‚å¸¸: ' + error.message;
                }
            }
            
            testResults.clipboard = tests;
            updateTestSection('clipboard', tests);
            completedTests += Object.keys(tests).length;
            updateProgress();
            
            addConsoleOutput(`Clipboard API æµ‹è¯•å®Œæˆ: ${Object.values(tests).filter(t => t.success).length}/${Object.keys(tests).length} é€šè¿‡`);
        }
        
        // æµ‹è¯•å¯¹è¯æ¡†API
        async function testDialogAPI() {
            addConsoleOutput('å¼€å§‹æµ‹è¯• Dialog API...');
            
            const tests = {
                'showOpenDialog': { success: !!window.electronAPI?.showOpenDialog },
                'showSaveDialog': { success: !!window.electronAPI?.showSaveDialog },
                'showMessageBox': { success: !!window.electronAPI?.showMessageBox },
                'showErrorBox': { success: !!window.electronAPI?.showErrorBox }
            };
            
            testResults.dialog = tests;
            updateTestSection('dialog', tests);
            completedTests += Object.keys(tests).length;
            updateProgress();
            
            addConsoleOutput(`Dialog API æµ‹è¯•å®Œæˆ: ${Object.values(tests).filter(t => t.success).length}/${Object.keys(tests).length} é€šè¿‡`);
        }
        
        // æµ‹è¯•åº”ç”¨ä¿¡æ¯API
        async function testAppInfoAPI() {
            addConsoleOutput('å¼€å§‹æµ‹è¯• App Info API...');
            
            const tests = {
                'getAppVersion': { success: !!window.electronAPI?.getAppVersion },
                'getAppName': { success: !!window.electronAPI?.getAppName }
            };
            
            // å®é™…æµ‹è¯•è·å–åº”ç”¨ä¿¡æ¯
            if (tests.getAppVersion.success) {
                try {
                    const result = await window.electronAPI.getAppVersion();
                    if (result.success) {
                        tests.getAppVersion.details = `ç‰ˆæœ¬: ${result.version}`;
                    } else {
                        tests.getAppVersion.success = false;
                        tests.getAppVersion.details = 'è·å–ç‰ˆæœ¬å¤±è´¥';
                    }
                } catch (error) {
                    tests.getAppVersion.success = false;
                    tests.getAppVersion.details = 'è°ƒç”¨å¼‚å¸¸: ' + error.message;
                }
            }
            
            if (tests.getAppName.success) {
                try {
                    const result = await window.electronAPI.getAppName();
                    if (result.success) {
                        tests.getAppName.details = `åç§°: ${result.name}`;
                    } else {
                        tests.getAppName.success = false;
                        tests.getAppName.details = 'è·å–åç§°å¤±è´¥';
                    }
                } catch (error) {
                    tests.getAppName.success = false;
                    tests.getAppName.details = 'è°ƒç”¨å¼‚å¸¸: ' + error.message;
                }
            }
            
            testResults.appInfo = tests;
            updateTestSection('appInfo', tests);
            completedTests += Object.keys(tests).length;
            updateProgress();
            
            addConsoleOutput(`App Info API æµ‹è¯•å®Œæˆ: ${Object.values(tests).filter(t => t.success).length}/${Object.keys(tests).length} é€šè¿‡`);
        }
        
        // æµ‹è¯•çª—å£æ§åˆ¶API
        async function testWindowAPI() {
            addConsoleOutput('å¼€å§‹æµ‹è¯• Window API...');
            
            const tests = {
                'minimizeWindow': { success: !!window.electronAPI?.minimizeWindow },
                'maximizeWindow': { success: !!window.electronAPI?.maximizeWindow },
                'closeWindow': { success: !!window.electronAPI?.closeWindow },
                'isMaximized': { success: !!window.electronAPI?.isMaximized }
            };
            
            // æµ‹è¯•çª—å£çŠ¶æ€æŸ¥è¯¢
            if (tests.isMaximized.success) {
                try {
                    const result = await window.electronAPI.isMaximized();
                    if (result.success) {
                        tests.isMaximized.details = `çª—å£çŠ¶æ€: ${result.isMaximized ? 'å·²æœ€å¤§åŒ–' : 'æœªæœ€å¤§åŒ–'}`;
                    } else {
                        tests.isMaximized.success = false;
                        tests.isMaximized.details = 'è·å–çŠ¶æ€å¤±è´¥';
                    }
                } catch (error) {
                    tests.isMaximized.success = false;
                    tests.isMaximized.details = 'è°ƒç”¨å¼‚å¸¸: ' + error.message;
                }
            }
            
            testResults.window = tests;
            updateTestSection('window', tests);
            completedTests += Object.keys(tests).length;
            updateProgress();
            
            addConsoleOutput(`Window API æµ‹è¯•å®Œæˆ: ${Object.values(tests).filter(t => t.success).length}/${Object.keys(tests).length} é€šè¿‡`);
        }
        
        // æµ‹è¯•å·¥å…·å‡½æ•°
        async function testUtilityFunctions() {
            addConsoleOutput('å¼€å§‹æµ‹è¯•å·¥å…·å‡½æ•°...');
            
            const utilityFunctions = [
                'openInBrowser', 'openFolder', 'showInFolder', 'deleteToTrash',
                'copyToClipboard', 'pasteFromClipboard', 'showConfirmDialog',
                'showInfoDialog', 'showErrorDialog', 'getAppInfo',
                'minimizeApp', 'maximizeApp', 'selectFile', 'selectFolder'
            ];
            
            const tests = {};
            utilityFunctions.forEach(funcName => {
                tests[funcName] = { 
                    success: typeof window[funcName] === 'function',
                    details: typeof window[funcName] === 'function' ? 'å‡½æ•°å¯ç”¨' : 'å‡½æ•°ä¸å­˜åœ¨'
                };
            });
            
            testResults.utility = tests;
            updateTestSection('utility', tests);
            completedTests += Object.keys(tests).length;
            updateProgress();
            
            const availableCount = Object.values(tests).filter(t => t.success).length;
            addConsoleOutput(`å·¥å…·å‡½æ•°æµ‹è¯•å®Œæˆ: ${availableCount}/${Object.keys(tests).length} å¯ç”¨`);
        }
        
        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        async function runAllTests() {
            addConsoleOutput('ğŸš€ å¼€å§‹è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶...');
            
            // é‡ç½®è®¡æ•°å™¨
            completedTests = 0;
            totalTests = 4 + 4 + 4 + 2 + 4 + 15; // å„ä¸ªæµ‹è¯•çš„æ•°é‡
            updateProgress();
            
            // æ˜¾ç¤ºæ‘˜è¦
            document.getElementById('testSummary').style.display = 'block';
            document.getElementById('summaryTitle').textContent = 'æµ‹è¯•è¿›è¡Œä¸­...';
            document.getElementById('summaryText').textContent = 'æ­£åœ¨æ‰§è¡Œæ‰€æœ‰APIæµ‹è¯•ï¼Œè¯·ç¨å€™...';
            
            try {
                await waitForElectronAPI();
                
                await testShellAPI();
                await new Promise(resolve => setTimeout(resolve, 200)); // çŸ­æš‚å»¶è¿Ÿ
                
                await testClipboardAPI();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testDialogAPI();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testAppInfoAPI();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testWindowAPI();
                await new Promise(resolve => setTimeout(resolve, 200));
                
                await testUtilityFunctions();
                
                // æ˜¾ç¤ºæœ€ç»ˆç»“æœ
                const allTests = {...testResults.shell, ...testResults.clipboard, ...testResults.dialog, 
                                 ...testResults.appInfo, ...testResults.window, ...testResults.utility};
                const totalCount = Object.keys(allTests).length;
                const successCount = Object.values(allTests).filter(t => t.success).length;
                
                document.getElementById('summaryTitle').textContent = 'âœ… æµ‹è¯•å®Œæˆï¼';
                document.getElementById('summaryText').textContent = 
                    `æ€»è®¡: ${totalCount} ä¸ªæµ‹è¯•ï¼Œ${successCount} ä¸ªé€šè¿‡ï¼Œ${totalCount - successCount} ä¸ªå¤±è´¥`;
                
                addConsoleOutput(`ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆï¼é€šè¿‡ç‡: ${((successCount/totalCount)*100).toFixed(1)}%`, 'success');
                
            } catch (error) {
                addConsoleOutput('æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: ' + error.message, 'error');
                document.getElementById('summaryTitle').textContent = 'âŒ æµ‹è¯•å¼‚å¸¸';
                document.getElementById('summaryText').textContent = 'æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º';
            }
        }
        
        // å¿«é€Ÿæµ‹è¯•ï¼ˆåªæµ‹è¯•åŸºç¡€åŠŸèƒ½ï¼‰
        async function runQuickTest() {
            addConsoleOutput('âš¡ å¼€å§‹å¿«é€Ÿæµ‹è¯•...');
            
            completedTests = 0;
            totalTests = 10; // å¿«é€Ÿæµ‹è¯•é¡¹ç›®æ•°
            updateProgress();
            
            document.getElementById('testSummary').style.display = 'block';
            document.getElementById('summaryTitle').textContent = 'å¿«é€Ÿæµ‹è¯•ä¸­...';
            document.getElementById('summaryText').textContent = 'æ­£åœ¨æ£€æŸ¥æ ¸å¿ƒAPIåŠŸèƒ½...';
            
            try {
                await waitForElectronAPI();
                
                // åªæµ‹è¯•æ ¸å¿ƒAPI
                const quickTests = {
                    'ElectronAPI å¯ç”¨æ€§': { success: !!window.electronAPI },
                    'Shell - openExternal': { success: !!window.electronAPI?.openExternal },
                    'Clipboard - writeText': { success: !!window.electronAPI?.writeText },
                    'Clipboard - readText': { success: !!window.electronAPI?.readText },
                    'Dialog - showMessageBox': { success: !!window.electronAPI?.showMessageBox },
                    'App - getAppVersion': { success: !!window.electronAPI?.getAppVersion },
                    'Window - minimizeWindow': { success: !!window.electronAPI?.minimizeWindow },
                    'å·¥å…·å‡½æ•° - copyToClipboard': { success: !!window.copyToClipboard },
                    'å·¥å…·å‡½æ•° - showInfoDialog': { success: !!window.showInfoDialog },
                    'å·¥å…·å‡½æ•° - getAppInfo': { success: !!window.getAppInfo }
                };
                
                // æ›´æ–°æ˜¾ç¤º
                let html = '';
                let successCount = 0;
                
                for (const [testName, result] of Object.entries(quickTests)) {
                    const resultClass = result.success ? 'result-success' : 'result-error';
                    const resultText = result.success ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥';
                    
                    if (result.success) successCount++;
                    
                    html += `
                        <div class="test-item">
                            <div class="test-name">${testName}</div>
                            <div class="test-result ${resultClass}">${resultText}</div>
                        </div>
                    `;
                    
                    completedTests++;
                    updateProgress();
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                // æ˜¾ç¤ºåœ¨ç¬¬ä¸€ä¸ªæµ‹è¯•åŒºåŸŸ
                document.getElementById('shellTestResults').innerHTML = html;
                
                document.getElementById('summaryTitle').textContent = 'âš¡ å¿«é€Ÿæµ‹è¯•å®Œæˆï¼';
                document.getElementById('summaryText').textContent = 
                    `æ ¸å¿ƒåŠŸèƒ½: ${successCount}/${Object.keys(quickTests).length} å¯ç”¨`;
                
                addConsoleOutput(`âš¡ å¿«é€Ÿæµ‹è¯•å®Œæˆï¼æ ¸å¿ƒåŠŸèƒ½å¯ç”¨ç‡: ${((successCount/Object.keys(quickTests).length)*100).toFixed(1)}%`, 'success');
                
            } catch (error) {
                addConsoleOutput('å¿«é€Ÿæµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: ' + error.message, 'error');
            }
        }
        
        // æ¸…é™¤ç»“æœ
        function clearResults() {
            document.getElementById('testSummary').style.display = 'none';
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('consoleOutput').innerHTML = 
                '<div>ğŸ“‹ æ§åˆ¶å°è¾“å‡ºå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div><div>ğŸ’¡ æç¤ºï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹æ›´è¯¦ç»†çš„æ—¥å¿—</div>';
            
            // é‡ç½®æ‰€æœ‰æµ‹è¯•åŒºåŸŸ
            const sections = ['shell', 'clipboard', 'dialog', 'appInfo', 'window', 'utility'];
            sections.forEach(section => {
                document.getElementById(section + 'TestResults').innerHTML = '<p>ç­‰å¾…æµ‹è¯•...</p>';
                document.querySelector(`#${section}Tests .status-indicator`).className = 'status-indicator status-info';
            });
            
            testResults = { shell: {}, clipboard: {}, dialog: {}, appInfo: {}, window: {}, utility: {} };
            completedTests = 0;
            totalTests = 0;
            
            addConsoleOutput('æµ‹è¯•ç»“æœå·²æ¸…é™¤', 'info');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            addConsoleOutput('ElectronAPI æµ‹è¯•ä¸­å¿ƒå·²å°±ç»ª');
            addConsoleOutput('ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•ï¼Œæˆ–æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—');
            
            // æ£€æŸ¥APIå¯ç”¨æ€§
            if (window.electronAPI) {
                addConsoleOutput('âœ… ElectronAPI å·²æ£€æµ‹åˆ°', 'success');
            } else {
                addConsoleOutput('âš ï¸ ElectronAPI æœªæ£€æµ‹åˆ°ï¼Œå¯èƒ½éœ€è¦åœ¨Electronç¯å¢ƒä¸­è¿è¡Œ', 'warning');
            }
        });
    </script>
</body>
</html>